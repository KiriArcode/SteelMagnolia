<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <script>
    if (location.hostname.includes('github.io')) {
      var base = document.createElement('base');
      base.href = '/SteelMagnolia/';
      document.head.insertBefore(base, document.head.firstChild);
    }
  </script>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <title>SteelMagnolia</title>
  
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'bg-void': '#0a0a0f',
            'bg-card': '#13131a',
            'bg-elevated': '#1c1c26',
            'bg-input': '#252532',
            gray: {
              900: '#0a0a0f',
              800: '#13131a',
              700: '#1c1c26',
              600: '#252532',
              500: '#6b7280',
              400: '#9ca3af',
            }
          },
          borderRadius: {
            '4xl': '2rem',
          },
          boxShadow: {
            'glow-pink': '0 0 30px rgba(236, 72, 153, 0.4)',
            'glow-purple': '0 0 30px rgba(168, 85, 247, 0.4)',
            'glow-orange': '0 0 30px rgba(249, 115, 22, 0.4)',
          },
        }
      }
    }
  </script>
  
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.3/dist/cdn.min.js"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/custom.css">
</head>
<body class="bg-[#0a0a0f] text-white min-h-screen" x-data="gymTracker()" x-init="init()">

  <!-- Achievement Notification -->
  <div 
    x-show="newAchievementUnlocked"
    class="fixed top-4 left-4 right-4 z-50 animate-[pop_0.3s_ease-out]"
    x-transition
  >
    <div class="bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 rounded-2xl p-4 shadow-[0_0_30px_rgba(236,72,153,0.6)]">
      <div class="flex items-center gap-3">
        <span class="text-4xl" x-text="newAchievementUnlocked?.emoji"></span>
        <div class="flex-1">
          <p class="font-bold text-lg" x-text="newAchievementUnlocked?.message"></p>
          <p class="text-sm text-white/80" x-text="newAchievementUnlocked?.description"></p>
        </div>
        <button 
          type="button"
          @click="newAchievementUnlocked = null"
          class="p-2 hover:bg-white/20 rounded-lg"
        >
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: DASHBOARD ========== -->
  <template x-if="page === 'dashboard'">
  <div class="min-h-screen p-4 pb-24">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <div>
        <h1 class="text-2xl font-bold">SteelMagnolia</h1>
        <p class="text-gray-400 text-sm">–ü—Ä–∏–≤–µ—Ç, <span x-text="profile.name"></span>! üëã</p>
      </div>
      <div class="text-right">
        <p class="text-sm text-gray-400">–°—Ç—Ä–∏–∫</p>
        <p class="text-2xl font-bold text-orange-400 flex items-center gap-1">
          <i data-lucide="flame" class="w-5 h-5"></i>
          <span x-text="stats.streak"></span>
        </p>
      </div>
    </div>

    <!-- Week Progress Card -->
    <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
      <div class="flex justify-between items-center mb-3">
        <span class="text-gray-400">–≠—Ç–∞ –Ω–µ–¥–µ–ª—è</span>
        <span class="text-lg font-semibold">
          <span x-text="stats.weekCompleted"></span>/<span x-text="stats.weekTotal"></span>
        </span>
      </div>
      
      <!-- Week days (—Ç–∞–ø ‚Äî –æ—Ç–º–µ—Ç–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É: –ø—Ä–æ–≥—É–ª–∫–∞, –∑–∞–ª –∏ —Ç.–¥.) -->
      <div class="flex gap-1 mb-3">
        <template x-for="(day, index) in getWeekDaysStatus()" :key="day.dayName + day.dateStr">
          <div class="flex-1 text-center">
            <button
              type="button"
              @click="markDayAsWorkout(day)"
              :disabled="!day.canMark"
              :title="day.canMark ? (day.completed ? '–î–µ–Ω—å —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π' : '–û—Ç–º–µ—Ç–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (–ø—Ä–æ–≥—É–ª–∫–∞, –∑–∞–ª)') : ''"
              class="w-full h-10 rounded-lg mb-1 flex items-center justify-center transition-colors disabled:cursor-default"
              :class="{
                'bg-green-500 hover:bg-green-600 active:scale-95 cursor-pointer': day.completed && day.canMark,
                'bg-blue-500 animate-pulse hover:bg-blue-600 active:scale-95 cursor-pointer': day.isToday && !day.completed && day.canMark,
                'bg-[#252532] hover:bg-[#1c1c26] active:scale-95 cursor-pointer transition-colors': day.canMark && !day.completed && !day.isToday,
                'bg-[#252532] cursor-default': !day.canMark
              }"
            >
              <i x-show="day.completed" data-lucide="check" class="w-5 h-5"></i>
              <i x-show="day.canMark && !day.completed" data-lucide="plus" class="w-4 h-4 opacity-70"></i>
            </button>
            <span class="text-xs text-gray-500" x-text="day.dayName"></span>
          </div>
        </template>
      </div>
      
      <!-- Stats row -->
      <div class="flex justify-between text-sm">
        <div class="text-center">
          <p class="text-gray-400">–ö–∞—Ä–¥–∏–æ</p>
          <p class="font-semibold text-blue-400"><span x-text="stats.cardioMinutes"></span> –º–∏–Ω</p>
        </div>
        <div class="text-center">
          <p class="text-gray-400">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</p>
          <p class="font-semibold text-green-400">‚åÄ <span x-text="(stats.avgMood ?? 0).toFixed(1)"></span></p>
        </div>
      </div>
    </div>

    <!-- Level & XP Card -->
    <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-3xl p-4 mb-4 border border-purple-500/30">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-2">
          <span class="text-2xl" x-text="getLevelInfo(profile.level).emoji"></span>
          <div>
            <p class="font-bold text-lg">–£—Ä–æ–≤–µ–Ω—å <span x-text="profile.level"></span></p>
            <p class="text-sm text-purple-300" x-text="getLevelInfo(profile.level).name"></p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-sm text-gray-400">XP</p>
          <p class="text-xl font-bold text-purple-400" x-text="profile.totalXp.toLocaleString()"></p>
        </div>
      </div>
      <div class="relative h-3 bg-[#1c1c26] rounded-full overflow-hidden">
        <div 
          class="h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full transition-all duration-500"
          :style="`width: ${getXPProgress().progress}%`"
        ></div>
      </div>
      <p class="text-xs text-gray-400 mt-2">
        <span x-text="getXPProgress().xpNeeded"></span> XP –¥–æ —É—Ä–æ–≤–Ω—è <span x-text="profile.level + 1"></span>
      </p>
    </div>

    <!-- Cycle Phase Card -->
    <div 
      class="rounded-3xl p-4 mb-4 border backdrop-blur-sm"
      :class="`bg-gradient-to-r ${getCyclePhase().color || 'from-gray-500/20 to-gray-600/20'}/20 border-${getCyclePhase().color?.split('-')[1] || 'gray'}-500/30`"
    >
      <!-- –ï—Å–ª–∏ —Ü–∏–∫–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω -->
      <template x-if="profile.cycleDay">
        <div>
          <div class="flex items-center gap-3 mb-2">
            <span class="text-3xl" x-text="getCyclePhase().emoji"></span>
            <div class="flex-1">
              <div class="flex items-center gap-2">
                <p class="font-bold text-lg" x-text="getCyclePhase().name"></p>
                <button
                  type="button"
                  @click="showCyclePhaseInfo = !showCyclePhaseInfo"
                  class="p-1 hover:bg-white/10 rounded-lg transition-colors"
                  title="–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ–∞–∑–µ"
                >
                  <i data-lucide="info" class="w-4 h-4 text-gray-400"></i>
                </button>
              </div>
              <p class="text-sm text-gray-300">–î–µ–Ω—å <span x-text="profile.cycleDay"></span> —Ü–∏–∫–ª–∞</p>
            </div>
          </div>
          <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ —Ñ–∞–∑–µ -->
          <div 
            x-show="showCyclePhaseInfo"
            x-transition
            class="mb-2 p-3 bg-[#1c1c26]/50 rounded-xl border border-white/10"
          >
            <p class="text-xs text-gray-300 leading-relaxed" x-text="getCyclePhase().description"></p>
          </div>
          <p class="text-sm text-gray-300" x-text="getCyclePhase().recommendation"></p>
          <button 
            type="button"
            @click="page = 'cycle-settings'"
            class="mt-2 text-xs text-purple-400 hover:text-purple-300"
          >
            –ò–∑–º–µ–Ω–∏—Ç—å –¥–µ–Ω—å —Ü–∏–∫–ª–∞ ‚Üí
          </button>
        </div>
      </template>
      <!-- –ï—Å–ª–∏ —Ü–∏–∫–ª –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω -->
      <template x-if="!profile.cycleDay">
        <div>
          <div class="flex items-center gap-3 mb-2">
            <span class="text-3xl">üå∏</span>
            <div class="flex-1">
              <p class="font-bold text-lg">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞</p>
              <p class="text-sm text-gray-300">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</p>
            </div>
          </div>
          <p class="text-sm text-gray-300 mb-3">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ñ–∞–∑—ã —Ü–∏–∫–ª–∞ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</p>
          <button 
            type="button"
            @click="page = 'cycle-settings'"
            class="w-full py-2 bg-gradient-to-r from-pink-500 to-rose-600 rounded-xl font-semibold text-sm hover:from-pink-600 hover:to-rose-700 transition-all"
          >
            –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ü–∏–∫–ª ‚Üí
          </button>
        </div>
      </template>
    </div>

    <!-- Goal Card -->
    <div class="bg-gradient-to-r from-pink-500/20 to-orange-500/20 rounded-3xl p-4 mb-4 border border-pink-500/30">
      <div class="flex items-center justify-between mb-2">
        <div>
          <p class="font-bold text-lg">
            <span x-show="profile.goal === 'lose'">–ü–æ—Ö—É–¥–µ–Ω–∏–µ</span>
            <span x-show="profile.goal === 'gain'">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</span>
            <span x-show="profile.goal === 'tone'">–¢–æ–Ω—É—Å –∏ —Ä–µ–ª—å–µ—Ñ</span>
            <span x-show="profile.goal === 'maintain'">–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã</span>
          </p>
          <p class="text-sm text-gray-300" x-text="getGoalRecommendations().strength"></p>
        </div>
        <button 
          type="button"
          @click="page = 'goals'"
          class="p-2 hover:bg-white/10 rounded-lg transition-colors"
          title="–ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–ª—å"
        >
          <i data-lucide="target" class="w-5 h-5 text-pink-400"></i>
        </button>
      </div>
    </div>

    <!-- Measurements Card -->
    <div 
      class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5 cursor-pointer hover:bg-[#1c1c26] transition-colors"
      @click="page = 'measurements'"
      x-show="measurements && measurements.length > 0"
    >
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold flex items-center gap-2">
          <i data-lucide="ruler" class="w-5 h-5 text-gray-400"></i>
          –ò–∑–º–µ—Ä–µ–Ω–∏—è
        </h3>
        <i data-lucide="chevron-right" class="w-5 h-5 text-gray-400"></i>
      </div>
      <div class="grid grid-cols-3 gap-2 text-sm">
        <div>
          <p class="text-gray-400">–¢–∞–ª–∏—è</p>
          <p class="font-bold" x-text="measurements[0]?.waist || '‚Äî'"></p>
          <p class="text-xs" :class="getMeasurementChange('waist')?.isPositive ? 'text-green-400' : 'text-red-400'" x-show="getMeasurementChange('waist')">
            <span x-text="getMeasurementChange('waist')?.change > 0 ? '+' : ''"></span><span x-text="getMeasurementChange('waist')?.change.toFixed(1)"></span> —Å–º
          </p>
        </div>
        <div>
          <p class="text-gray-400">–ë—ë–¥—Ä–∞</p>
          <p class="font-bold" x-text="measurements[0]?.hips || '‚Äî'"></p>
          <p class="text-xs" :class="getMeasurementChange('hips')?.isPositive ? 'text-green-400' : 'text-red-400'" x-show="getMeasurementChange('hips')">
            <span x-text="getMeasurementChange('hips')?.change > 0 ? '+' : ''"></span><span x-text="getMeasurementChange('hips')?.change.toFixed(1)"></span> —Å–º
          </p>
        </div>
        <div>
          <p class="text-gray-400">–í–µ—Å</p>
          <p class="font-bold" x-text="measurements[0]?.weight || '‚Äî'"></p>
          <p class="text-xs" :class="getMeasurementChange('weight')?.isPositive ? 'text-green-400' : 'text-red-400'" x-show="getMeasurementChange('weight')">
            <span x-text="getMeasurementChange('weight')?.change > 0 ? '+' : ''"></span><span x-text="getMeasurementChange('weight')?.change.toFixed(1)"></span> –∫–≥
          </p>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="grid grid-cols-3 gap-3 mb-4">
      <button
        type="button"
        @click="page = 'achievements'"
        class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-4 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all"
      >
        <i data-lucide="award" class="w-6 h-6 mx-auto mb-2 text-purple-400"></i>
        <p class="text-xs font-semibold">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</p>
        <p class="text-xs text-gray-400" x-text="achievements.filter(a => a.unlocked).length + '/' + achievements.length"></p>
      </button>
      <button
        type="button"
        @click="page = 'stretch'"
        class="bg-gradient-to-r from-pink-500/20 to-orange-500/20 rounded-2xl p-4 border border-pink-500/30 hover:from-pink-500/30 hover:to-orange-500/30 transition-all"
      >
        <i data-lucide="activity" class="w-6 h-6 mx-auto mb-2 text-pink-400"></i>
        <p class="text-xs font-semibold">–†–∞—Å—Ç—è–∂–∫–∞</p>
      </button>
      <button
        type="button"
        @click="page = measurements.length > 0 ? 'measurements' : 'add-measurement'"
        class="bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-2xl p-4 border border-cyan-500/30 hover:from-cyan-500/30 hover:to-blue-500/30 transition-all"
      >
        <i data-lucide="ruler" class="w-6 h-6 mx-auto mb-2 text-cyan-400"></i>
        <p class="text-xs font-semibold">–ò–∑–º–µ—Ä–µ–Ω–∏—è</p>
      </button>
    </div>

    <!-- HR Zones Card -->
    <div class="bg-gradient-to-r from-red-900/50 to-orange-900/50 rounded-3xl p-4 mb-4 border border-red-700/50">
      <div class="flex items-center gap-2 mb-2">
        <i data-lucide="heart" class="w-5 h-5 text-red-400"></i>
        <span class="font-semibold">–ü—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã</span>
        <span class="text-xs text-gray-400 ml-auto">–í–æ–∑—Ä–∞—Å—Ç: <span x-text="profile.age"></span></span>
      </div>
      <div class="grid grid-cols-3 gap-2 text-center">
        <div class="bg-[#1c1c26]/50 rounded-lg p-2 border border-white/5">
          <p class="text-xs text-gray-400">–ú–∞–∫—Å –ß–°–°</p>
          <p class="text-xl font-bold text-red-400" x-text="profile.maxHR"></p>
        </div>
        <div class="bg-[#1c1c26]/50 rounded-lg p-2 border border-white/5">
          <p class="text-xs text-gray-400">–ñ–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ</p>
          <p class="text-xl font-bold text-orange-400">
            <span x-text="profile.fatBurnLow"></span>-<span x-text="profile.fatBurnHigh"></span>
          </p>
        </div>
        <div class="bg-[#1c1c26]/50 rounded-lg p-2 border border-white/5">
          <p class="text-xs text-gray-400">–ò–Ω—Ç–µ—Ä–≤–∞–ª</p>
          <p class="text-xl font-bold text-yellow-400">
            <span x-text="profile.intervalLow"></span>-<span x-text="profile.intervalHigh"></span>
          </p>
        </div>
      </div>
    </div>

    <!-- Start Workout Button -->
    <button
      type="button"
      @click="page = 'select-workout'"
      class="w-full bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 rounded-2xl p-5 mb-4 flex items-center justify-between shadow-[0_0_30px_rgba(236,72,153,0.4)] active:scale-[0.98] transition-all hover:shadow-[0_0_40px_rgba(236,72,153,0.6)]"
    >
      <div class="flex items-center gap-3">
        <div class="w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center">
          <i data-lucide="dumbbell" class="w-8 h-8"></i>
        </div>
        <div class="text-left">
          <p class="font-bold text-lg">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</p>
          <p class="text-blue-200 text-sm" x-text="getTodayPlan()"></p>
        </div>
      </div>
      <i data-lucide="chevron-right" class="w-6 h-6"></i>
    </button>

    <!-- Recent Workouts -->
    <div class="bg-[#13131a] rounded-3xl p-4 border border-white/5">
      <h3 class="font-semibold mb-3 flex items-center gap-2">
        <i data-lucide="calendar" class="w-5 h-5 text-gray-400"></i>
        –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
      </h3>
      <div class="space-y-2">
        <template x-for="workout in recentWorkouts" :key="workout.id">
          <div class="flex items-center gap-3 bg-[#1c1c26]/50 rounded-xl p-3 border border-white/5 hover:bg-[#1c1c26]/70 transition-colors">
            <div 
              class="w-10 h-10 rounded-lg flex items-center justify-center shrink-0"
              :class="getWorkoutTypeColor(workout.type)"
            >
              <i :data-lucide="workout.type === 'cardio' ? 'activity' : 'dumbbell'" class="w-5 h-5"></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="font-medium" x-text="workout.name"></p>
              <p class="text-sm text-gray-400" x-text="workout.date"></p>
            </div>
            <div class="text-right shrink-0">
              <p class="text-lg" x-text="getMoodEmoji(workout.mood)"></p>
              <p class="text-xs text-gray-400"><span x-text="workout.mood ?? workout.moodPost ?? 7"></span>/10</p>
            </div>
            <div class="flex gap-1 shrink-0">
              <button
                type="button"
                @click="editWorkout(workout)"
                class="p-2 hover:bg-[#252532] rounded-lg transition-colors"
                title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
              >
                <i data-lucide="pencil" class="w-4 h-4"></i>
              </button>
              <button
                type="button"
                @click="deleteWorkout(workout.id)"
                class="p-2 hover:bg-red-500/30 rounded-lg text-red-400"
                title="–£–¥–∞–ª–∏—Ç—å"
              >
                <i data-lucide="trash-2" class="w-4 h-4"></i>
              </button>
            </div>
          </div>
        </template>
      </div>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: SELECT WORKOUT ========== -->
  <template x-if="page === 'select-workout'">
  <div class="min-h-screen p-4">
    
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-3">
        <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
          <i data-lucide="chevron-left" class="w-6 h-6"></i>
        </button>
        <h1 class="text-xl font-bold">–í—ã–±–µ—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</h1>
      </div>
      <button type="button" @click="openManageExercises()" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏">
        <i data-lucide="settings" class="w-5 h-5"></i>
      </button>
    </div>

    <!-- Debug info (—É–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ –æ—Ç–ª–∞–¥–∫–∏) -->
    <div class="text-xs text-gray-500 mb-4">
      workoutList length: <span x-text="workoutList.length"></span>
    </div>

    <!-- Workout Cards -->
    <div class="space-y-3">
      <template x-for="workout in workoutList" :key="workout.key">
        <button
          type="button"
          @click="planWorkoutKey = workout.key; page = 'workout-plan'"
          class="w-full rounded-3xl p-5 flex items-center gap-4 shadow-lg active:scale-[0.98] transition-all border backdrop-blur-sm"
          :class="workout.gradient + ' border-opacity-30 hover:shadow-[0_0_30px_rgba(236,72,153,0.2)]'"
        >
          <div class="w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center p-2">
            <div x-html="getExerciseIcon(workout.exercises[0]?.icon || 'dumbbell')"></div>
          </div>
          <div class="flex-1 text-left">
            <p class="text-2xl mb-1" x-text="workout.emoji"></p>
            <p class="font-bold text-lg" x-text="workout.name"></p>
            <p class="text-white/70 text-sm">
              <span x-text="workout.exercises.length"></span> —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π + 
              <span x-text="workout.cardio"></span> –º–∏–Ω –∫–∞—Ä–¥–∏–æ
            </p>
          </div>
          <i data-lucide="chevron-right" class="w-6 h-6"></i>
        </button>
      </template>

      <!-- Cardio Only -->
      <button
        type="button"
        @click="isCardioOnly = true; page = 'cardio'; saveSession()"
        class="w-full bg-gradient-to-r from-cyan-500 to-teal-600 rounded-3xl p-5 flex items-center gap-4 shadow-[0_0_30px_rgba(6,182,212,0.4)] active:scale-[0.98] transition-all hover:shadow-[0_0_40px_rgba(6,182,212,0.6)] border border-cyan-500/30"
      >
        <div class="w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center p-2">
          <div x-html="getExerciseIcon('treadmill')"></div>
        </div>
        <div class="flex-1 text-left">
          <p class="text-2xl mb-1">üèÉ</p>
          <p class="font-bold text-lg">–¢–æ–ª—å–∫–æ –∫–∞—Ä–¥–∏–æ</p>
          <p class="text-white/70 text-sm">–ü–Ω/–°—Ä/–ü—Ç ‚Äî 45-60 –º–∏–Ω—É—Ç</p>
        </div>
        <i data-lucide="chevron-right" class="w-6 h-6"></i>
      </button>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: –ü–õ–ê–ù –¢–†–ï–ù–ò–†–û–í–ö–ò ========== -->
  <template x-if="page === 'workout-plan'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'select-workout'; planWorkoutKey = null" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold" x-text="workouts[planWorkoutKey]?.name || '–ü–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'"></h1>
    </div>
    <template x-if="planWorkoutKey">
      <div>
        <div class="space-y-2 mb-6" :data-ver="inactiveVersion">
          <template x-for="(ex, i) in (workouts[planWorkoutKey]?.exercises || [])" :key="ex.id + '_' + (inactiveVersion || 0)">
            <div 
              draggable="true"
              @dragstart="onDragStart($event, i)"
              @dragover.prevent="onDragOver($event, i)"
              @drop="onDrop($event, i, 'plan')"
              @dragend="onDragEnd()"
              class="flex items-center gap-3 p-3 rounded-xl transition-opacity cursor-move border border-white/5 hover:bg-[#1c1c26]/50"
              :class="{
                'bg-[#13131a] opacity-60': isExerciseInactive(planWorkoutKey, ex.id),
                'bg-[#13131a] opacity-50': dragState.dragging === i,
                'bg-[#13131a]': !isExerciseInactive(planWorkoutKey, ex.id) && dragState.dragging !== i
              }"
            >
              <div class="w-10 h-10 rounded-lg bg-[#1c1c26] flex items-center justify-center shrink-0" x-html="getExerciseIcon(ex.icon)"></div>
              <div class="flex-1 min-w-0">
                <p class="font-medium" x-text="ex.name"></p>
                <p class="text-xs text-gray-400" x-text="(ex.sets || 3) + '√ó' + (ex.reps || 12)"></p>
              </div>
              <label class="flex items-center gap-2 shrink-0 cursor-pointer" @click.stop>
                <input type="checkbox" :checked="isExerciseInactive(planWorkoutKey, ex.id)" @change="toggleExerciseInactive(planWorkoutKey, ex.id)" class="rounded">
                <span class="text-xs text-gray-500">–ù–µ—Ç –≤ –∑–∞–ª–µ</span>
              </label>
            </div>
          </template>
        </div>
        <button
          type="button"
          @click="startWorkoutFromPlan()"
          class="w-full py-4 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 font-bold text-lg shadow-[0_0_20px_rgba(168,85,247,0.4)]"
        >
          –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
        </button>
      </div>
    </template>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: WORKOUT ========== -->
  <template x-if="page === 'workout'">
  <div class="min-h-screen pb-32">
    
    <!-- Header -->
    <div 
      class="p-4"
      :class="currentWorkout?.gradient || 'bg-gradient-to-r from-purple-500 to-violet-600'"
    >
      <div class="flex items-center justify-between mb-2">
        <button type="button" @click="page = 'select-workout'" class="p-2 hover:bg-white/20 rounded-lg">
          <i data-lucide="chevron-left" class="w-6 h-6"></i>
        </button>
        <div class="text-center">
          <p class="text-sm opacity-80" x-text="currentWorkout?.name"></p>
          <p class="font-bold">
            <span x-text="currentExerciseIndex + 1"></span> / 
            <span x-text="currentWorkout?.exercises.length"></span>
          </p>
        </div>
        <button type="button" @click="page = 'complete'" class="p-2 hover:bg-white/20 rounded-lg text-sm">
          –ó–∞–≤–µ—Ä—à–∏—Ç—å
        </button>
      </div>
      
      <!-- Progress bar -->
      <div class="h-2 bg-white/20 rounded-full overflow-hidden">
        <div 
          class="h-full bg-white transition-all duration-300"
          :style="`width: ${((currentExerciseIndex + 1) / (currentWorkout?.exercises.length || 1)) * 100}%`"
        ></div>
      </div>
    </div>

      <!-- Exercise Card -->
    <div class="p-4">
      <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
        <div class="flex items-start gap-4 mb-4">
          <div class="w-20 h-20 bg-[#1c1c26] rounded-xl p-2">
            <div x-html="getExerciseIcon(currentExercise?.icon)"></div>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-2">
              <h2 class="font-bold text-lg" x-text="(selectedAlt?.name || selectedAlt) || currentExercise?.name"></h2>
              <button
                type="button"
                x-show="getCurrentVideoUrl()"
                @click="openVideoModal()"
                class="p-1.5 rounded-lg bg-blue-500/30 hover:bg-blue-500/50 text-blue-400"
                title="–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ"
              >
                <i data-lucide="play" class="w-4 h-4"></i>
              </button>
            </div>
            <p class="text-gray-400">
              <span x-text="currentExercise?.sets"></span>√ó<span x-text="currentExercise?.reps"></span>
            </p>
            <p 
              x-show="currentExercise?.lastWeight !== 0"
              class="text-sm text-blue-400 flex items-center gap-1 mt-1"
            >
              <i data-lucide="trending-up" class="w-4 h-4"></i>
              –ü—Ä–æ—à–ª—ã–π —Ä–∞–∑: <span x-text="currentExercise?.lastWeight"></span> –∫–≥
            </p>
          </div>
        </div>

        <!-- Alternatives Toggle -->
        <button
          type="button"
          @click="showAlternatives = !showAlternatives"
          class="w-full text-left text-sm text-gray-400 flex items-center gap-2 mb-2"
        >
          <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
          <span x-text="showAlternatives ? '–°–∫—Ä—ã—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã' : `–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (${currentExercise?.alts?.length || 0})`"></span>
        </button>
        
        <!-- Alternatives List -->
        <div x-show="showAlternatives" x-transition class="space-y-2 mb-4">
          <template x-for="(alt, i) in currentExercise?.alts" :key="i">
            <button
              type="button"
              @click="selectedAlt = (selectedAlt === alt ? null : alt); showAlternatives = false"
              class="w-full text-left p-2 rounded-lg text-sm transition-colors"
              :class="selectedAlt === alt ? 'bg-purple-500/30 border border-purple-500 shadow-[0_0_15px_rgba(168,85,247,0.3)]' : 'bg-[#252532] border border-white/5'"
            >
              <span x-text="alt.name || alt"></span>
              <span x-show="alt.forWhat" class="text-gray-500 block text-xs mt-0.5" x-text="'‚Üí ' + alt.forWhat"></span>
            </button>
          </template>
          <button
            type="button"
            x-show="selectedAlt"
            @click="selectedAlt = null"
            class="w-full text-left p-2 rounded-lg text-sm bg-[#252532] border border-white/5"
          >
            ‚Üê –í–µ—Ä–Ω—É—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ
          </button>
        </div>
      </div>

      <!-- Completed Sets -->
      <div x-show="currentExerciseSets.length > 0" class="mb-4">
        <p class="text-sm text-gray-400 mb-2">–ó–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:</p>
        <div class="flex flex-wrap gap-2">
          <template x-for="(set, i) in currentExerciseSets" :key="i">
            <div class="bg-lime-500/20 border border-lime-500/30 rounded-xl px-4 py-2 text-sm inline-flex items-center gap-2">
              <span class="text-lime-400">‚úì</span>
              <span class="text-lime-300 font-semibold" x-text="set.weight + ' –∫–≥'"></span>
              <span class="text-lime-300/50"> √ó </span>
              <span class="text-lime-300" x-text="set.reps"></span>
            </div>
          </template>
        </div>
      </div>

      <!-- Input Form -->
      <div class="bg-[#13131a] rounded-3xl p-4 border border-white/5">
        <p class="text-center text-gray-400 mb-4">
          –ü–æ–¥—Ö–æ–¥ <span x-text="currentExerciseSets.length + 1"></span>
        </p>
        
        <!-- Weight Input -->
        <div class="mb-6">
          <p class="text-sm text-gray-400 text-center mb-2">–í–µ—Å (–∫–≥)</p>
          <div class="flex items-center justify-center gap-4">
            <button
              type="button"
              @click="currentWeight = Math.max(0, currentWeight - 2)"
              class="w-14 h-14 bg-[#252532] border border-pink-500/20 rounded-2xl flex items-center justify-center text-pink-400 text-2xl active:bg-pink-500/20 active:scale-95 transition-all"
            >
              ‚àí
            </button>
            <div class="w-28 text-center">
              <p class="text-5xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent" x-text="currentWeight"></p>
              <p class="text-sm text-gray-500">–∫–≥</p>
            </div>
            <button
              type="button"
              @click="currentWeight += 2"
              class="w-14 h-14 bg-gradient-to-br from-purple-500/30 to-pink-500/30 border border-pink-500/30 rounded-2xl flex items-center justify-center text-pink-300 text-2xl active:from-purple-500/50 active:to-pink-500/50 active:scale-95 transition-all"
            >
              +
            </button>
          </div>
        </div>

        <!-- Reps Input -->
        <div class="mb-6">
          <p class="text-sm text-gray-400 text-center mb-2">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</p>
          <div class="flex items-center justify-center gap-4">
            <button
              type="button"
              @click="currentReps = Math.max(1, currentReps - 1)"
              class="w-14 h-14 bg-[#252532] border border-pink-500/20 rounded-2xl flex items-center justify-center text-pink-400 text-2xl active:bg-pink-500/20 active:scale-95 transition-all"
            >
              ‚àí
            </button>
            <div class="w-28 text-center">
              <p class="text-5xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent" x-text="currentReps"></p>
              <p class="text-sm text-gray-500">–ø–æ–≤—Ç</p>
            </div>
            <button
              type="button"
              @click="currentReps++"
              class="w-14 h-14 bg-gradient-to-br from-purple-500/30 to-pink-500/30 border border-pink-500/30 rounded-2xl flex items-center justify-center text-pink-300 text-2xl active:from-purple-500/50 active:to-pink-500/50 active:scale-95 transition-all"
            >
              +
            </button>
          </div>
        </div>

        <!-- Record Button -->
        <button
          type="button"
          @click="recordSet()"
          class="w-full bg-gradient-to-r from-lime-500 to-emerald-600 rounded-xl py-4 font-bold text-lg flex items-center justify-center gap-2 active:scale-[0.98] transition-all shadow-[0_0_20px_rgba(132,204,22,0.4)] hover:shadow-[0_0_30px_rgba(132,204,22,0.6)]"
        >
          <i data-lucide="check" class="w-6 h-6"></i>
          –ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–¥—Ö–æ–¥
        </button>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="fixed bottom-0 left-0 right-0 bg-[#13131a]/90 backdrop-blur-lg border-t border-white/5 p-4">
      <div class="flex gap-4 max-w-md mx-auto">
        <button
          type="button"
          :disabled="currentExerciseIndex === 0"
          @click="prevExercise()"
          class="flex-1 bg-[#252532] rounded-xl py-3 font-semibold disabled:opacity-50 flex items-center justify-center gap-2"
        >
          <i data-lucide="chevron-left" class="w-5 h-5"></i>
          –ù–∞–∑–∞–¥
        </button>
        <button
          type="button"
          @click="nextExercise()"
          class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl py-3 font-semibold flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(168,85,247,0.4)]"
        >
          –î–∞–ª–µ–µ
          <i data-lucide="chevron-right" class="w-5 h-5"></i>
        </button>
      </div>
    </div>
    
    <!-- Video Modal -->
    <template x-if="videoModalOpen">
      <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" @click.self="closeVideoModal()">
        <div class="relative w-full max-w-2xl aspect-video bg-black rounded-xl overflow-hidden">
          <iframe 
            :src="videoModalUrl" 
            class="w-full h-full"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
          ></iframe>
          <button
            type="button"
            @click="closeVideoModal()"
            class="absolute top-2 right-2 p-2 rounded-full bg-black/60 hover:bg-black/80"
          >
            <i data-lucide="x" class="w-5 h-5"></i>
          </button>
        </div>
      </div>
    </template>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: –û–¢–î–´–• (–¢–ê–ô–ú–ï–†) ========== -->
  <template x-if="page === 'rest'">
  <div class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="text-6xl font-bold bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400 bg-clip-text text-transparent mb-4" x-text="restTimer.secondsLeft"></div>
    <p class="text-gray-400 mb-8" x-text="restTimer.type === 'exercise' ? '–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ' : '–°–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥'"></p>
      <button
        type="button"
        @click="endRest()"
        class="w-full max-w-xs bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 rounded-xl py-4 font-bold text-lg shadow-[0_0_20px_rgba(168,85,247,0.4)]"
        x-text="restTimer.type === 'exercise' ? '–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ' : '–°–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥'"
      ></button>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: CARDIO ========== -->
  <template x-if="page === 'cardio'">
  <div class="min-h-screen p-4">
    
    <!-- Header -->
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = isCardioOnly ? 'select-workout' : 'workout'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold" x-text="isCardioOnly ? '–ö–∞—Ä–¥–∏–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞' : `–ö–∞—Ä–¥–∏–æ (${currentWorkout?.cardio || 30} –º–∏–Ω)`"></h1>
    </div>

    <!-- HR Zones reminder -->
    <div class="bg-gradient-to-r from-red-900/30 to-orange-900/30 rounded-2xl p-3 mb-4 border border-red-700/30">
      <p class="text-sm text-gray-300 flex items-center gap-2">
        <i data-lucide="heart" class="w-4 h-4 text-red-400"></i>
        –¶–µ–ª–µ–≤–æ–π –ø—É–ª—å—Å: 
        <span class="font-bold text-orange-400">
          <span x-text="profile.fatBurnLow"></span>-<span x-text="profile.fatBurnHigh"></span> —É–¥/–º–∏–Ω
        </span>
      </p>
    </div>

    <!-- Cardio Type -->
    <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
      <p class="text-sm text-gray-400 mb-3">–¢–∏–ø –∫–∞—Ä–¥–∏–æ</p>
      <div class="grid grid-cols-3 gap-3">
        <template x-for="type in cardioTypes" :key="type.id">
          <button
            type="button"
            @click="cardioData.type = type.id"
            class="p-3 rounded-xl flex flex-col items-center gap-2 transition-colors"
            :class="cardioData.type === type.id ? 'bg-gradient-to-br from-cyan-500 to-teal-600 shadow-[0_0_20px_rgba(6,182,212,0.5)]' : 'bg-[#252532]'"
          >
            <div class="w-12 h-12" x-html="getExerciseIcon(type.icon)"></div>
            <span class="text-sm" x-text="type.name"></span>
          </button>
        </template>
      </div>
    </div>

    <!-- Duration -->
    <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
      <p class="text-sm text-gray-400 mb-3">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç—ã)</p>
      <div class="flex items-center justify-center gap-4">
        <button
          type="button"
          @click="cardioData.duration = Math.max(5, cardioData.duration - 5)"
          class="w-14 h-14 bg-[#252532] border border-cyan-500/20 rounded-2xl flex items-center justify-center text-cyan-400 text-2xl active:bg-cyan-500/20 active:scale-95 transition-all"
        >
          ‚àí
        </button>
        <div class="w-28 text-center">
          <p class="text-5xl font-bold bg-gradient-to-r from-cyan-400 to-teal-400 bg-clip-text text-transparent" x-text="cardioData.duration"></p>
          <p class="text-sm text-gray-500">–º–∏–Ω</p>
        </div>
        <button
          type="button"
          @click="cardioData.duration += 5"
          class="w-14 h-14 bg-gradient-to-br from-cyan-500/30 to-teal-500/30 border border-cyan-500/30 rounded-2xl flex items-center justify-center text-cyan-300 text-2xl active:from-cyan-500/50 active:to-teal-500/50 active:scale-95 transition-all"
        >
          +
        </button>
      </div>
      
      <!-- Quick select -->
      <div class="flex justify-center gap-2 mt-3">
        <template x-for="min in [20, 30, 45, 60]" :key="min">
          <button
            type="button"
            @click="cardioData.duration = min"
            class="px-4 py-2 rounded-lg text-sm transition-colors"
            :class="cardioData.duration === min ? 'bg-gradient-to-br from-cyan-500 to-teal-600 shadow-[0_0_15px_rgba(6,182,212,0.4)]' : 'bg-[#252532]'"
            x-text="min"
          ></button>
        </template>
      </div>
    </div>

    <!-- Podcast -->
    <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
      <p class="text-sm text-gray-400 mb-2">üéß –ü–æ–¥–∫–∞—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</p>
      <input
        type="text"
        placeholder="NotebookLM: AI –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞..."
        x-model="cardioData.podcast"
        class="w-full bg-[#252532] rounded-xl p-3 outline-none focus:ring-2 focus:ring-cyan-500 border border-white/5"
      >
    </div>

    <button
      type="button"
      @click="page = 'complete'; saveSession()"
      class="w-full bg-gradient-to-r from-cyan-500 to-teal-600 rounded-xl py-4 font-bold text-lg active:scale-[0.98] transition-all shadow-[0_0_30px_rgba(6,182,212,0.4)] hover:shadow-[0_0_40px_rgba(6,182,212,0.6)]"
      x-text="isCardioOnly ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–∞—Ä–¥–∏–æ' : '–î–∞–ª–µ–µ ‚Üí'"
    ></button>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: COMPLETE ========== -->
  <template x-if="page === 'complete'">
  <div class="min-h-screen p-4">
    
    <!-- Success Header -->
    <div class="text-center mb-6">
      <div class="w-20 h-20 bg-gradient-to-br from-lime-500/20 to-emerald-600/20 border border-lime-500/30 rounded-full flex items-center justify-center mx-auto mb-4 shadow-[0_0_25px_rgba(132,204,22,0.5)]">
        <i data-lucide="award" class="w-10 h-10 text-lime-400"></i>
      </div>
      <h1 class="text-2xl font-bold mb-2">–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! üí™</h1>
      <p class="text-gray-400">–û—Å—Ç–∞–ª–æ—Å—å –æ—Ü–µ–Ω–∏—Ç—å —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ</p>
    </div>

    <!-- Mood Post Workout -->
    <div class="bg-[#1c1c26] rounded-3xl p-5 mb-4">
      <p class="text-sm text-gray-400 mb-3">–ö–∞–∫ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–π—á–∞—Å?</p>
      <div class="flex items-center justify-between mb-4">
        <span class="text-4xl" x-text="getMoodEmoji(moodPost)"></span>
        <span class="text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent" x-text="moodPost"></span>
      </div>
      <div class="slider-with-fill">
        <div class="slider-track slider-track-bg"></div>
        <div class="slider-track slider-track-fill slider-track-fill-green" :style="`width: ${((moodPost - 1) / 9 * 100)}%`"></div>
        <input
          type="range"
          min="1"
          max="10"
          x-model="moodPost"
          class="slider-input"
        >
      </div>
      <div class="flex justify-between text-xs text-gray-500 mt-1">
        <span>–ü–ª–æ—Ö–æ</span>
        <span>–û—Ç–ª–∏—á–Ω–æ</span>
      </div>
    </div>

    <!-- Mood Day -->
    <div class="bg-[#1c1c26] rounded-3xl p-5 mb-4">
      <p class="text-sm text-gray-400 mb-3">–û–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –∑–∞ –¥–µ–Ω—å</p>
      <div class="flex items-center justify-between mb-4">
        <span class="text-4xl" x-text="getMoodEmoji(moodDay)"></span>
        <span class="text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent" x-text="moodDay"></span>
      </div>
      <div class="slider-with-fill">
        <div class="slider-track slider-track-bg"></div>
        <div class="slider-track slider-track-fill slider-track-fill-blue" :style="`width: ${((moodDay - 1) / 9 * 100)}%`"></div>
        <input
          type="range"
          min="1"
          max="10"
          x-model="moodDay"
          class="slider-input"
        >
      </div>
    </div>

    <!-- Notes -->
    <div class="bg-[#13131a] rounded-3xl p-4 mb-6 border border-white/5">
      <p class="text-sm text-gray-400 mb-2">üìù –ó–∞–º–µ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</p>
      <textarea
        placeholder="–ü–ª–µ—á–æ –ø–æ–±–∞–ª–∏–≤–∞–ª–æ, —Å–æ–∫—Ä–∞—Ç–∏–ª –≤–µ—Å –Ω–∞ –∂–∏–º–µ..."
        x-model="notes"
        class="w-full bg-[#252532] rounded-xl p-3 outline-none focus:ring-2 focus:ring-purple-500 min-h-[80px] resize-none border border-white/5"
      ></textarea>
    </div>

    <!-- Save Button -->
    <button
      type="button"
      @click="saveWorkout()"
      class="w-full bg-gradient-to-r from-lime-500 to-emerald-600 rounded-xl py-4 font-bold text-lg flex items-center justify-center gap-2 active:scale-[0.98] transition-all shadow-[0_0_30px_rgba(132,204,22,0.4)] hover:shadow-[0_0_40px_rgba(132,204,22,0.6)]"
    >
      <i data-lucide="check" class="w-6 h-6"></i>
      –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
    </button>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –¢–†–ï–ù–ò–†–û–í–ö–ò ========== -->
  <template x-if="page === 'edit-workout'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'dashboard'; editingWorkout = null" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</h1>
    </div>
    <template x-if="editingWorkout">
      <div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
          <p class="text-sm text-gray-400" x-text="editingWorkout.date"></p>
          <p class="font-bold text-lg" x-text="editingWorkout.name"></p>
        </div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
          <p class="text-sm text-gray-400 mb-3">–ü–æ–¥—Ö–æ–¥—ã</p>
          <template x-for="(set, i) in (editingWorkout.sets || [])" :key="i">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-sm text-gray-500 w-24 shrink-0" x-text="set.exerciseName || '–°–µ—Ç ' + (i+1)"></span>
              <input type="number" min="0" step="2" x-model.number="set.weight" class="w-16 bg-[#252532] rounded-lg px-2 py-1 text-center border border-white/5">
              <span class="text-gray-500">–∫–≥ √ó</span>
              <input type="number" min="1" x-model.number="set.reps" class="w-14 bg-[#252532] rounded-lg px-2 py-1 text-center border border-white/5">
              <button type="button" @click="editingWorkout.sets.splice(i, 1)" class="p-1 text-red-400 hover:bg-red-500/20 rounded">
                <i data-lucide="trash-2" class="w-4 h-4"></i>
              </button>
            </div>
          </template>
        </div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5" x-show="editingWorkout.cardio">
          <p class="text-sm text-gray-400 mb-2">–ö–∞—Ä–¥–∏–æ</p>
          <div class="flex items-center gap-2">
            <input type="number" min="0" x-model.number="editingWorkout.cardio.duration" class="w-20 bg-[#252532] rounded-lg px-2 py-1 border border-white/5">
            <span class="text-gray-500">–º–∏–Ω</span>
          </div>
        </div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
          <p class="text-sm text-gray-400 mb-2">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
          <input type="range" min="1" max="10" x-model.number="editingWorkout.moodPost" class="w-full">
          <span x-text="editingWorkout.moodPost ?? editingWorkout.mood ?? 7"></span>/10
        </div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
          <p class="text-sm text-gray-400 mb-2">–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –∑–∞ –¥–µ–Ω—å</p>
          <input type="range" min="1" max="10" x-model.number="editingWorkout.moodDay" class="w-full">
          <span x-text="editingWorkout.moodDay ?? 7"></span>/10
        </div>
        <div class="bg-[#13131a] rounded-3xl p-4 mb-4 border border-white/5">
          <p class="text-sm text-gray-400 mb-2">–ó–∞–º–µ—Ç–∫–∏</p>
          <textarea x-model="editingWorkout.notes" class="w-full bg-[#252532] rounded-xl p-3 min-h-[60px] border border-white/5"></textarea>
        </div>
        <button
          type="button"
          @click="saveEditedWorkout()"
          class="w-full bg-gradient-to-r from-lime-500 to-emerald-600 rounded-xl py-3 font-bold shadow-[0_0_20px_rgba(132,204,22,0.4)]"
        >
          –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        </button>
      </div>
    </template>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: –£–ü–†–ê–í–õ–ï–ù–ò–ï –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø–ú–ò ========== -->
  <template x-if="page === 'manage-exercises'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="managingWorkoutKey ? backToWorkoutList() : (page = 'select-workout')" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold" x-text="managingWorkoutKey ? (workouts[managingWorkoutKey]?.name || '') : '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏'"></h1>
    </div>
    
    <template x-if="!managingWorkoutKey">
      <div class="space-y-2">
        <template x-for="w in workoutList" :key="w.key">
          <button type="button" @click="selectWorkoutToManage(w.key)" class="w-full flex items-center gap-3 p-4 rounded-xl bg-[#13131a] hover:bg-[#1c1c26] border border-white/5 transition-colors">
            <span class="text-2xl" x-text="w.emoji"></span>
            <div class="flex-1 text-left">
              <p class="font-bold" x-text="w.name"></p>
              <p class="text-sm text-gray-400" x-text="(w.exercises?.length || 0) + ' —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π'"></p>
            </div>
            <i data-lucide="chevron-right" class="w-5 h-5"></i>
          </button>
        </template>
      </div>
    </template>
    
    <template x-if="managingWorkoutKey && editingExerciseIndex === -1">
      <div>
        <div class="space-y-2 mb-4" :data-ver="inactiveVersion">
          <template x-for="(ex, i) in (workouts[managingWorkoutKey]?.exercises || [])" :key="ex.id + '_' + (inactiveVersion || 0)">
            <div 
              draggable="true"
              @dragstart="onDragStart($event, i)"
              @dragover.prevent="onDragOver($event, i)"
              @drop="onDrop($event, i, 'manage')"
              @dragend="onDragEnd()"
              class="flex items-center gap-3 p-3 rounded-xl transition-opacity cursor-move border border-white/5 hover:bg-[#1c1c26]/50"
              :class="{
                'bg-[#13131a] opacity-60': isExerciseInactive(managingWorkoutKey, ex.id),
                'bg-[#13131a] opacity-50': dragState.dragging === i,
                'bg-[#13131a]': !isExerciseInactive(managingWorkoutKey, ex.id) && dragState.dragging !== i
              }"
            >
              <div class="w-10 h-10 rounded-lg bg-[#1c1c26] flex items-center justify-center shrink-0" x-html="getExerciseIcon(ex.icon)"></div>
              <div class="flex-1 min-w-0">
                <p class="font-medium" x-text="ex.name"></p>
                <p class="text-xs text-gray-400" x-text="(ex.sets || 3) + '√ó' + (ex.reps || 12)"></p>
              </div>
              <label class="flex items-center gap-1 shrink-0 cursor-pointer" title="–ù–µ—Ç –≤ –º–æ–µ–º –∑–∞–ª–µ" @click.stop>
                <input type="checkbox" :checked="isExerciseInactive(managingWorkoutKey, ex.id)" @change="toggleExerciseInactive(managingWorkoutKey, ex.id)" class="rounded">
                <i data-lucide="eye-off" class="w-4 h-4 text-gray-500"></i>
              </label>
              <button type="button" @click.stop="startEditExercise(i)" class="p-2 hover:bg-[#252532] rounded-lg"><i data-lucide="pencil" class="w-4 h-4"></i></button>
              <button type="button" @click.stop="deleteExerciseFromTemplate(i)" class="p-2 hover:bg-red-500/30 rounded-lg text-red-400"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
            </div>
          </template>
        </div>
        <button type="button" @click="startAddExercise()" class="w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 font-semibold flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(168,85,247,0.4)]">
          <i data-lucide="plus" class="w-5 h-5"></i>
          –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        </button>
      </div>
    </template>
    
    <template x-if="managingWorkoutKey && editingExerciseIndex !== -1">
      <div class="bg-[#13131a] rounded-3xl p-4 border border-white/5">
        <p class="text-sm text-gray-400 mb-3" x-text="editingExerciseIndex >= 0 ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '–ù–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ'"></p>
        <div class="space-y-3">
          <div>
            <label class="text-sm text-gray-400">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" x-model="exerciseForm.name" class="w-full bg-[#252532] rounded-lg p-3 mt-1 border border-white/5" placeholder="–ñ–∏–º –ª—ë–∂–∞">
          </div>
          <div class="flex gap-3">
            <div class="flex-1">
              <label class="text-sm text-gray-400">–°–µ—Ç—ã</label>
              <input type="number" min="1" x-model.number="exerciseForm.sets" class="w-full bg-[#252532] rounded-lg p-3 mt-1 border border-white/5">
            </div>
            <div class="flex-1">
              <label class="text-sm text-gray-400">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
              <input type="number" min="1" x-model.number="exerciseForm.reps" class="w-full bg-[#252532] rounded-lg p-3 mt-1 border border-white/5">
            </div>
          </div>
          <div>
            <label class="text-sm text-gray-400">–í–∏–¥–µ–æ (YouTube URL)</label>
            <input type="url" x-model="exerciseForm.videoUrl" class="w-full bg-[#252532] rounded-lg p-3 mt-1 border border-white/5" placeholder="https://youtube.com/watch?v=...">
          </div>
          <div>
            <div class="flex justify-between items-center mb-1">
              <label class="text-sm text-gray-400">–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã</label>
              <button type="button" @click="addAltExercise()" class="text-blue-400 text-sm">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <template x-for="(alt, ai) in (exerciseForm.alts || [])" :key="ai">
                <div class="flex gap-2 mb-2 p-2 rounded-lg bg-[#1c1c26]/50 border border-white/5">
                <input type="text" x-model="alt.name" class="flex-1 bg-[#252532] rounded px-2 py-1 text-sm border border-white/5" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                <input type="text" x-model="alt.forWhat" class="flex-1 bg-[#252532] rounded px-2 py-1 text-sm border border-white/5" placeholder="–î–ª—è —á–µ–≥–æ –∑–∞–º–µ–Ω–∞">
                <input type="url" x-model="alt.videoUrl" class="flex-1 bg-[#252532] rounded px-2 py-1 text-sm border border-white/5" placeholder="YouTube">
                <button type="button" @click="removeAltExercise(ai)" class="p-1 text-red-400 shrink-0"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
              </div>
            </template>
          </div>
          <div>
            <label class="text-sm text-gray-400">–ò–∫–æ–Ω–∫–∞</label>
            <select x-model="exerciseForm.icon" class="w-full bg-[#252532] rounded-lg p-3 mt-1 border border-white/5">
              <template x-for="k in getIconKeys()" :key="k">
                <option :value="k" x-text="k"></option>
              </template>
            </select>
          </div>
          <div class="flex gap-2">
            <button type="button" @click="saveExercise()" class="flex-1 py-3 rounded-xl bg-gradient-to-r from-lime-500 to-emerald-600 hover:from-lime-600 hover:to-emerald-700 font-semibold shadow-[0_0_15px_rgba(132,204,22,0.4)]">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" @click="editingExerciseIndex = -1" class="flex-1 py-3 rounded-xl bg-[#252532] hover:bg-[#1c1c26] font-semibold">–û—Ç–º–µ–Ω–∞</button>
          </div>
        </div>
      </div>
    </template>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: MEASUREMENTS ========== -->
  <template x-if="page === 'measurements'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-3">
        <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
          <i data-lucide="chevron-left" class="w-6 h-6"></i>
        </button>
        <h1 class="text-xl font-bold">–ò–∑–º–µ—Ä–µ–Ω–∏—è</h1>
      </div>
      <button 
        type="button" 
        @click="page = 'add-measurement'"
        class="p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-colors"
      >
        <i data-lucide="plus" class="w-5 h-5"></i>
      </button>
    </div>

    <div class="space-y-3">
      <template x-for="m in measurements.slice(0, 10)" :key="m.id">
        <div class="bg-[#13131a] rounded-2xl p-4 border border-white/5">
          <div class="flex justify-between items-start mb-3">
            <div>
              <p class="font-semibold" x-text="m.dateStr"></p>
              <p class="text-xs text-gray-400" x-text="new Date(m.date).toLocaleDateString('ru-RU', { weekday: 'long' })"></p>
            </div>
            <div class="flex items-center gap-2">
              <img x-show="m.photo" :src="m.photo" class="w-16 h-16 rounded-lg object-cover" />
              <button
                type="button"
                @click="deleteMeasurement(m.id)"
                class="p-2 hover:bg-red-500/30 rounded-lg text-red-400 transition-colors"
                title="–£–¥–∞–ª–∏—Ç—å"
              >
                <i data-lucide="trash-2" class="w-4 h-4"></i>
              </button>
            </div>
          </div>
          <div class="grid grid-cols-3 gap-2 text-sm">
            <div>
              <p class="text-gray-400">–¢–∞–ª–∏—è</p>
              <p class="font-bold" x-text="m.waist || '‚Äî'"></p>
            </div>
            <div>
              <p class="text-gray-400">–ë—ë–¥—Ä–∞</p>
              <p class="font-bold" x-text="m.hips || '‚Äî'"></p>
            </div>
            <div>
              <p class="text-gray-400">–í–µ—Å</p>
              <p class="font-bold" x-text="m.weight || '‚Äî'"></p>
            </div>
          </div>
        </div>
      </template>
      <div x-show="measurements.length === 0" class="text-center py-12 text-gray-400">
        <i data-lucide="ruler" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
        <p>–ù–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏–π</p>
        <button 
          type="button"
          @click="page = 'add-measurement'"
          class="mt-4 px-6 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl"
        >
          –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ
        </button>
      </div>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: ADD MEASUREMENT ========== -->
  <template x-if="page === 'add-measurement'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'measurements'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–ù–æ–≤–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ</h1>
    </div>

    <div class="space-y-4">
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–¢–∞–ª–∏—è (—Å–º)</label>
        <input 
          type="number" 
          x-model="measurementForm.waist"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
          placeholder="0"
        />
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–ë—ë–¥—Ä–∞ (—Å–º)</label>
        <input 
          type="number" 
          x-model="measurementForm.hips"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
          placeholder="0"
        />
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–ì—Ä—É–¥—å (—Å–º)</label>
        <input 
          type="number" 
          x-model="measurementForm.chest"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
          placeholder="0"
        />
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–†—É–∫–∞ (—Å–º)</label>
        <input 
          type="number" 
          x-model="measurementForm.arm"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
          placeholder="0"
        />
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–í–µ—Å (–∫–≥)</label>
        <input 
          type="number" 
          x-model="measurementForm.weight"
          step="0.1"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
          placeholder="0"
        />
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–§–æ—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <input 
          type="file" 
          accept="image/*"
          @change="handlePhotoUpload($event)"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
        />
      </div>
      <button 
        type="button"
        @click="saveMeasurement(measurementForm); measurementForm = {}; page = 'measurements'"
        class="w-full py-4 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 rounded-2xl font-bold shadow-[0_0_30px_rgba(236,72,153,0.4)]"
      >
        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏–µ
      </button>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: ACHIEVEMENTS ========== -->
  <template x-if="page === 'achievements'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h1>
    </div>

    <div class="grid grid-cols-2 gap-3">
      <template x-for="ach in achievements" :key="ach.id">
        <div 
          class="rounded-2xl p-4 border transition-all"
          :class="ach.unlocked 
            ? 'bg-gradient-to-br from-purple-500/30 to-pink-500/30 border-purple-500/50 shadow-[0_0_20px_rgba(168,85,247,0.3)]' 
            : 'bg-[#13131a] border-white/5 opacity-50'"
        >
          <div class="text-center">
            <span class="text-4xl block mb-2" x-text="ach.emoji"></span>
            <p class="font-bold text-sm mb-1" x-text="ach.name"></p>
            <p class="text-xs text-gray-400" x-text="ach.description"></p>
            <p x-show="ach.unlocked" class="text-xs text-purple-300 mt-2" x-text="new Date(ach.dateUnlocked).toLocaleDateString('ru-RU')"></p>
          </div>
        </div>
      </template>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: STRETCH ========== -->
  <template x-if="page === 'stretch'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–†–∞—Å—Ç—è–∂–∫–∞</h1>
    </div>

    <div x-show="!currentStretchProgram" class="space-y-3">
      <template x-for="program in stretchPrograms" :key="program.id">
        <button
          type="button"
          @click="startStretchProgram(program.id)"
          class="w-full bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-4 border border-purple-500/30 flex items-center gap-4 hover:from-purple-500/30 hover:to-pink-500/30 transition-all"
        >
          <span class="text-3xl" x-text="program.emoji"></span>
          <div class="flex-1 text-left">
            <p class="font-bold" x-text="program.name"></p>
            <p class="text-sm text-gray-400" x-text="program.duration + ' –º–∏–Ω'"></p>
          </div>
          <i data-lucide="chevron-right" class="w-5 h-5"></i>
        </button>
      </template>
    </div>

    <div x-show="currentStretchProgram" class="space-y-4">
      <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-4 border border-purple-500/30 text-center">
        <p class="text-2xl font-bold mb-2" x-text="currentStretchProgram.exercises[currentStretchExerciseIndex]?.name"></p>
        <p class="text-gray-300 mb-4" x-text="currentStretchProgram.exercises[currentStretchExerciseIndex]?.description"></p>
        <div class="text-6xl font-bold text-purple-400 mb-4" x-text="stretchTimer.secondsLeft || currentStretchProgram.exercises[currentStretchExerciseIndex]?.duration"></div>
        <button 
          type="button"
          @click="startStretchTimer()"
          x-show="!stretchTimer.intervalId"
          class="w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl font-bold"
        >
          –ù–∞—á–∞—Ç—å
        </button>
        <button 
          type="button"
          @click="skipStretchExercise()"
          x-show="stretchTimer.intervalId"
          class="w-full py-3 bg-[#252532] rounded-xl font-bold"
        >
          –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
        </button>
      </div>
      <div class="text-center text-sm text-gray-400">
        –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ <span x-text="currentStretchExerciseIndex + 1"></span> –∏–∑ <span x-text="currentStretchProgram.exercises.length"></span>
      </div>
      <button 
        type="button"
        @click="completeStretchSession()"
        x-show="currentStretchExerciseIndex >= currentStretchProgram.exercises.length - 1"
        class="w-full py-4 bg-gradient-to-r from-lime-500 to-emerald-600 rounded-2xl font-bold"
      >
        –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é
      </button>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: GOALS ========== -->
  <template x-if="page === 'goals'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–í—ã–±–æ—Ä —Ü–µ–ª–∏</h1>
    </div>

    <div class="space-y-3">
      <button
        type="button"
        @click="profile.goal = 'lose'; Storage.saveProfile(profile)"
        class="w-full bg-gradient-to-r from-red-500/20 to-orange-500/20 rounded-2xl p-4 border-2 transition-all"
        :class="profile.goal === 'lose' ? 'border-red-500' : 'border-white/5'"
      >
        <p class="font-bold text-lg mb-1">–ü–æ—Ö—É–¥–µ–Ω–∏–µ</p>
        <p class="text-sm text-gray-300" x-text="getGoalRecommendations().cardio"></p>
      </button>
      <button
        type="button"
        @click="profile.goal = 'gain'; Storage.saveProfile(profile)"
        class="w-full bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-2xl p-4 border-2 transition-all"
        :class="profile.goal === 'gain' ? 'border-blue-500' : 'border-white/5'"
      >
        <p class="font-bold text-lg mb-1">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</p>
        <p class="text-sm text-gray-300" x-text="getGoalRecommendations().strength"></p>
      </button>
      <button
        type="button"
        @click="profile.goal = 'tone'; Storage.saveProfile(profile)"
        class="w-full bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-2xl p-4 border-2 transition-all"
        :class="profile.goal === 'tone' ? 'border-pink-500' : 'border-white/5'"
      >
        <p class="font-bold text-lg mb-1">–¢–æ–Ω—É—Å –∏ —Ä–µ–ª—å–µ—Ñ</p>
        <p class="text-sm text-gray-300" x-text="getGoalRecommendations().strength"></p>
      </button>
      <button
        type="button"
        @click="profile.goal = 'maintain'; Storage.saveProfile(profile)"
        class="w-full bg-gradient-to-r from-gray-500/20 to-gray-600/20 rounded-2xl p-4 border-2 transition-all"
        :class="profile.goal === 'maintain' ? 'border-gray-500' : 'border-white/5'"
      >
        <p class="font-bold text-lg mb-1">–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã</p>
        <p class="text-sm text-gray-300" x-text="getGoalRecommendations().strength"></p>
      </button>
    </div>
  </div>
  </template>

  <!-- ========== –°–¢–†–ê–ù–ò–¶–ê: CYCLE SETTINGS ========== -->
  <template x-if="page === 'cycle-settings'">
  <div class="min-h-screen p-4 pb-24">
    <div class="flex items-center gap-3 mb-6">
      <button type="button" @click="page = 'dashboard'" class="p-2 hover:bg-[#13131a] rounded-lg transition-colors">
        <i data-lucide="chevron-left" class="w-6 h-6"></i>
      </button>
      <h1 class="text-xl font-bold">–¶–∏–∫–ª</h1>
    </div>

    <div class="space-y-4">
      <!-- –¢–µ–∫—É—â–∞—è —Ñ–∞–∑–∞ —Ü–∏–∫–ª–∞ -->
      <div x-show="profile.cycleDay" class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-4 border border-purple-500/30">
        <div class="flex items-center gap-3 mb-3">
          <span class="text-3xl" x-text="getCyclePhase().emoji"></span>
          <div class="flex-1">
            <div class="flex items-center gap-2">
              <p class="font-bold text-lg" x-text="getCyclePhase().name"></p>
              <button
                type="button"
                @click="showCyclePhaseInfo = !showCyclePhaseInfo"
                class="p-1 hover:bg-white/10 rounded-lg transition-colors"
                title="–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ–∞–∑–µ"
              >
                <i data-lucide="info" class="w-4 h-4 text-gray-400"></i>
              </button>
            </div>
            <p class="text-sm text-gray-300">–î–µ–Ω—å <span x-text="profile.cycleDay"></span> –∏–∑ <span x-text="profile.cycleLength || 28"></span></p>
          </div>
        </div>
        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ —Ñ–∞–∑–µ -->
        <div 
          x-show="showCyclePhaseInfo"
          x-transition
          class="mb-3 p-3 bg-[#1c1c26]/50 rounded-xl border border-white/10"
        >
          <p class="text-xs text-gray-300 leading-relaxed" x-text="getCyclePhase().description"></p>
        </div>
        <p class="text-sm text-gray-300 mb-3" x-text="getCyclePhase().recommendation"></p>
        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Ü–∏–∫–ª–∞ -->
        <div class="relative h-2 bg-[#1c1c26] rounded-full overflow-hidden">
          <div 
            class="h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full transition-all duration-300"
            :style="`width: ${((profile.cycleDay || 1) / (profile.cycleLength || 28)) * 100}%`"
          ></div>
        </div>
      </div>

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ü–∏–∫–ª–µ -->
      <div x-show="profile.lastPeriodStart" class="bg-[#13131a] rounded-2xl p-4 border border-white/5">
        <p class="text-sm text-gray-400 mb-1">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞</p>
        <p class="font-semibold" x-text="new Date(profile.lastPeriodStart).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' })"></p>
        <p x-show="profile.lastPeriodStart" class="text-xs text-gray-500 mt-2">
          –°–ª–µ–¥—É—é—â–µ–µ –æ–∂–∏–¥–∞–µ–º–æ–µ –Ω–∞—á–∞–ª–æ: 
          <span x-text="new Date(new Date(profile.lastPeriodStart).getTime() + (profile.cycleLength || 28) * 24 * 60 * 60 * 1000).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })"></span>
        </p>
      </div>

      <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–î–µ–Ω—å —Ü–∏–∫–ª–∞</label>
        <input 
          type="number" 
          min="1"
          max="35"
          x-model="profile.cycleDay"
          @change="updateCycleDay(profile.cycleDay)"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
        />
        <p class="text-xs text-gray-500 mt-1">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ —Ü–∏–∫–ª–∞</p>
      </div>
      <div>
        <label class="text-sm text-gray-400 mb-2 block">–î–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞ (–¥–Ω–µ–π)</label>
        <input 
          type="number" 
          min="21"
          max="35"
          x-model="profile.cycleLength"
          @change="Storage.saveProfile(profile); updateCycleDayAutomatically()"
          class="w-full bg-[#252532] rounded-xl p-3 border border-white/5"
        />
      </div>
      <button
        type="button"
        @click="setPeriodStart(new Date().toISOString())"
        class="w-full py-3 bg-gradient-to-r from-pink-500 to-rose-600 rounded-xl font-bold shadow-[0_0_20px_rgba(236,72,153,0.4)] hover:shadow-[0_0_30px_rgba(236,72,153,0.6)] transition-all"
      >
        –û—Ç–º–µ—Ç–∏—Ç—å –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞
      </button>
    </div>
  </div>
  </template>

  <!-- Scripts - –ü–û–†–Ø–î–û–ö –í–ê–ñ–ï–ù! -->
  <script src="./js/data.js"></script>
  <script src="./js/storage.js"></script>
  <script src="./icons/exercises.js"></script>
  <script src="./js/app.js"></script>
  
  <!-- Lucide Icons init -->
  <script>
    document.addEventListener('alpine:initialized', () => {
      console.log('Alpine initialized, creating icons...');
      lucide.createIcons();
      
      var createIconsTimer;
      const observer = new MutationObserver(() => {
        clearTimeout(createIconsTimer);
        createIconsTimer = setTimeout(() => lucide.createIcons(), 50);
      });
      observer.observe(document.body, { childList: true, subtree: true });
    });
  </script>
  
  <!-- Register Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.warn('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
